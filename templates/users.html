{% extends "base.html" %}
{% block content %}
<h2>All Users</h2>

<form method="GET">
    <input type="text" name="search" placeholder="Search name, phone, or email" value="{{ search }}">
    <button type="submit">Search</button>
</form>

<table>
<tr><th>ID</th><th>Name</th><th>Phone</th><th>Email</th><th>Registered</th><th>Bookings</th><th>Status</th><th>Actions</th></tr>
{% for user in users %}
<tr>
    <td>{{ user.id }}</td>
    <td>{{ user.name }}</td>
    <td>{{ user.phone }}</td>
    <td>{{ user.email }}</td>
    <td>{{ user.created_at }}</td>
    <td>{{ user.total_bookings }}</td>
    <td>{{ "Blocked" if user.is_blocked else "Active" }}</td>
    <td>
        <a href="{{ url_for('user_details', user_id=user.id) }}">View</a> |
        {% if user.is_blocked %}
        <a href="{{ url_for('unblock_user', user_id=user.id) }}">Unblock</a>
        {% else %}
        <a href="{{ url_for('block_user', user_id=user.id) }}">Block</a>
        {% endif %}
        | <a href="{{ url_for('delete_user', user_id=user.id) }}" onclick="return confirm('Delete this user?')">Delete</a>
    </td>
</tr>
{% endfor %}
</table>
{% endblock %}
